<!DOCTYPE html>
<html>
    
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>
        </title>
        <link rel="stylesheet" href="jquery.mobile-1.1.1.min.css"
        />
        <link rel="stylesheet" href="my.css" />
        <style>
            /* App custom styles */
        </style>
        <script src="jquery-1.8.1.min.js">
        </script>
        <script src="jquery.mobile-1.1.1.min.js">
        </script>
        <script src="my.js">
        </script>
        <script type="text/javascript" charset="utf-8" src="cordova-2.0.0.js">
        </script>
        <link rel="stylesheet" type="text/css" href="jqm-datebox-1.1.0.css" /> 
        <script type="text/javascript" src="jqm-datebox-1.1.0.core.js"></script>
        <script type="text/javascript" src="jqm-datebox-1.1.0.mode.datebox.js"></script>
        <script type="text/javascript" src="jquery.mobile.datebox.i18n.en_US.utf8.js"></script>
    </head>
    
    <body>
        <!-- Home -->
        <div data-role="page" id="page1">
            <div data-theme="a" data-role="header" data-position="fixed">
                <h3>
                    LMN Calculator
                </h3>
            </div>
            <div data-role="content" style="padding: 15px">
                <div data-role="navbar" data-iconpos="top">
                    <ul>
                        <li>
                            <a href="#page3" data-theme="b" data-icon="">
                                LNM
                            </a>
                        </li>
                        <li>
                            <a href="#page5" data-theme="b" data-icon="">
                                Weeks/Days
                            </a>
                        </li>
                        <li>
                            <a href="#page4" data-theme="b" data-icon="">
                                EDD
                            </a>
                        </li>
                        <li>
                            <a href="#page6" data-theme="b" data-icon="">
                                Past Date
                            </a>
                        </li>
                    </ul>
                </div>
                <div style=" text-align:center">
                    <img style="width: 100px; height: 100px" src="images/preg_icon.png">
                </div>
                <div data-role="collapsible-set" data-theme="b" data-content-theme="a">
                    <div data-role="collapsible" data-collapsed="true">
                        <h3>
                            How to use this app
                        </h3>
                        <div>
                            <p>
                                Select from the selection bar above the appropriate date selection.
                            </p>
                            <p><u>LNM - Last Normal Mentruation</u></br></br>Submit the last normal mentruation date that is know for the 
                                pregnancy.
                            </p>
                            <p><u>Weeks and Days</u></br></br>Submit the weeks and days of the current pregnancy.
                            </p>
                            <p><u>EDD - Expected Date of Delivery</u></br></br>Submit the expected date of delivery that is known for the
                                pregnancy.
                            </p>
                            <p><u>Past Date</u></br></br>Submit a past date with its associate weeks/days for the pregnancy.
                            </p>

                        </div>
                    </div>
                    <div data-role="collapsible" data-collapsed="true">
                        <h3>
                            Disclaimer
                        </h3>
                        <div>
                            <p>
                                This application is not a substitute for medical advice. Any and all liability
                                arising directly or indirectly from the use of this application is hereby
                                disclaimed. The information herein is provided "as is" and without any
                                warranty expressed or implied. All direct, indirect, special, incidental,
                                consequential or punitive damages arising from any use of this application
                                or data contained herein is disclaimed and excluded.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <script type="text/javascript">
                $("#page1").on("pageshow", onPageShow);

                function onPageShow(e,data)
                {
                    clearValues();  
                }
            </script>
        </div>
        <!-- LNM -->
        <div data-role="page" id="page3">
            <div data-theme="a" data-role="header" data-position="fixed">
                <h3>
                    LMN Calculator
                </h3>
            </div>
            <div data-role="content" style="padding: 15px">
                <div data-role="navbar" data-iconpos="top">
                    <ul>
                        <li>
                            <a href="#page3" data-theme="b" data-icon="">
                                LNM
                            </a>
                        </li>
                        <li>
                            <a href="#page5" data-theme="b" data-icon="">
                                Weeks/Days
                            </a>
                        </li>
                        <li>
                            <a href="#page4" data-theme="b" data-icon="">
                                EDD
                            </a>
                        </li>
                        <li>
                            <a href="#page6" data-theme="b" data-icon="">
                                Past Date
                            </a>
                        </li>
                    </ul>
                </div>
                <script type="text/javascript">
                $("#page3").on("pageshow", onPageShow);

                function onPageShow(e,data)
                {
                    clearValues();  
                }
                </script>
                <form action="" method="POST">
                    <div data-role="fieldcontain">
                        <fieldset data-role="controlgroup">
                            <label for="textinput6">
                                Last Normal Mentruation
                            </label>    
                            <input name="lnm" id="textinput6" type="date" data-role="datebox"
                               data-options='{"mode": "datebox"}' value="">
                        </fieldset>
                    </div>
                </form>
                <input type="button" data-theme="b" value="Calculate" onClick="location.href='#page7';">
            </div>
        </div>
        <!-- Weeks Days -->
        <div data-role="page" id="page5">
            <div data-theme="a" data-role="header" data-position="fixed">
                <h3>
                    LMN Calculator
                </h3>
            </div>
            <div data-role="content" style="padding: 15px">
                <div data-role="navbar" data-iconpos="top">
                    <ul>
                        <li>
                            <a href="#page3" data-theme="b" data-icon="">
                                LNM
                            </a>
                        </li>
                        <li>
                            <a href="#page5" data-theme="b" data-icon="">
                                Weeks/Days
                            </a>
                        </li>
                        <li>
                            <a href="#page4" data-theme="b" data-icon="">
                                EDD
                            </a>
                        </li>
                        <li>
                            <a href="#page6" data-theme="b" data-icon="">
                                Past Date
                            </a>
                        </li>
                    </ul>
                </div>
                <script type="text/javascript">
                $("#page5").on("pageshow", onPageShow);

                function onPageShow(e,data)
                {
                    clearValues();  
                }
                </script>
                <form action="" method="POST">
                    <div data-role="fieldcontain">
                        <fieldset data-role="controlgroup">
                            <label for="textinput7">
                                Weeks
                            </label>
                            <input name="nowweeks" id="textinput7" placeholder="" value="0" type="range" min="0" max="39">
                        </fieldset>
                    </div>
                    <div data-role="fieldcontain">
                        <fieldset data-role="controlgroup">
                            <label for="textinput15">
                                Days
                            </label>
                            <input name="nowdays" id="textinput15" placeholder="" value="0" type="range" min="0" max="6">
                        </fieldset>
                    </div>
                    <input type="button" data-theme="b" value="Calculate" onClick="location.href='#page7';">
                </form>
            </div>
        </div>
        <!-- EDD -->
        <div data-role="page" id="page4">
            <div data-theme="a" data-role="header" data-position="fixed">
                <h3>
                    LMN Calculator
                </h3>
            </div>
            <div data-role="content" style="padding: 15px">
                <div data-role="navbar" data-iconpos="top">
                    <ul>
                        <li>
                            <a href="#page3" data-theme="b" data-icon="">
                                LNM
                            </a>
                        </li>
                        <li>
                            <a href="#page5" data-theme="b" data-icon="">
                                Weeks/Days
                            </a>
                        </li>
                        <li>
                            <a href="#page4" data-theme="b" data-icon="">
                                EDD
                            </a>
                        </li>
                        <li>
                            <a href="#page6" data-theme="b" data-icon="">
                                Past Date
                            </a>
                        </li>
                    </ul>
                </div>
                <script type="text/javascript">
                $("#page4").on("pageshow", onPageShow);

                function onPageShow(e,data)
                {
                    clearValues();  
                }
                </script>
                <form action="">
                    <div data-role="fieldcontain">
                        <fieldset data-role="controlgroup">
                            <label for="textinput8">
                                Expected Date of Delivery
                            </label>
                            <input name="edd" id="textinput8" type="date" data-role="datebox"
                               data-options='{"mode": "datebox"}' value="">
                        </fieldset>
                    </div>
                    <input type="button" data-theme="b" value="Calculate" onClick="location.href='#page7';">
                </form>
            </div>
        </div>
        <!-- Past Date -->
        <div data-role="page" id="page6">
            <div data-theme="a" data-role="header" data-position="fixed">
                <h3>
                    LMN Calculator
                </h3>
            </div>
            <div data-role="content" style="padding: 15px">
                <div data-role="navbar" data-iconpos="top">
                    <ul>
                        <li>
                            <a href="#page3" data-theme="b" data-icon="">
                                LNM
                            </a>
                        </li>
                        <li>
                            <a href="#page5" data-theme="b" data-icon="">
                                Weeks/Days
                            </a>
                        </li>
                        <li>
                            <a href="#page4" data-theme="b" data-icon="">
                                EDD
                            </a>
                        </li>
                        <li>
                            <a href="#page6" data-theme="b" data-icon="">
                                Past Date
                            </a>
                        </li>
                    </ul>
                </div>
                <script type="text/javascript">
                $("#page6").on("pageshow", onPageShow);

                function onPageShow(e,data)
                {
                    clearValues();  
                }
                </script>
                <form action="">
                    <div data-role="fieldcontain">
                        <fieldset data-role="controlgroup">
                            <label for="textinput9">
                                Past Date
                            </label>
                            <input name="pastdate" id="textinput9" type="date" data-role="datebox"
                               data-options='{"mode": "datebox"}' value="">
                        </fieldset>
                    </div>
                    <div data-role="fieldcontain">
                        <fieldset data-role="controlgroup">
                            <label for="textinput11">
                                Weeks
                            </label>
                            <input name="pastweeks" id="textinput11" placeholder="" value="0" type="range" min="0" max="39">
                        </fieldset>
                    </div>
                    <div data-role="fieldcontain">
                        <fieldset data-role="controlgroup">
                            <label for="textinput12">
                                Past Days
                            </label>
                            <input name="pastdays" id="textinput12" placeholder="" value="0" type="range" min="0" max="6">
                        </fieldset>
                    </div>
                    <input type="button" data-theme="b" value="Calculate" onClick="location.href='#page7';">
                </form>
            </div>
        </div>
        <!-- Result -->
        <div data-role="page" id="page7">
            
            <div data-theme="a" data-role="header" data-position="fixed">
                <h3>
                    LMN Calculator
                </h3>
            </div>
            <div data-role="content" style="padding: 15px">
                <div data-role="navbar" data-iconpos="top">
                    <ul>
                        <li>
                            <a href="#page3" data-theme="b" data-icon="">
                                LNM
                            </a>
                        </li>
                        <li>
                            <a href="#page5" data-theme="b" data-icon="">
                                Weeks/Days
                            </a>
                        </li>
                        <li>
                            <a href="#page4" data-theme="b" data-icon="">
                                EDD
                            </a>
                        </li>
                        <li>
                            <a href="#page6" data-theme="b" data-icon="">
                                Past Date
                            </a>
                        </li>
                    </ul>
                </div>
                <h4>
                    Result
                </h4>
                <div>
                    <p id="result">
                    </p>
                </div>
                <a data-role="button" data-transition="fade" data-theme="b" href="#page1">
                    Home
                </a>
                <script type="text/javascript">
                $("#page7").on("pageshow", onPageShow);

                function onPageShow(e,data)
                {
                    var lnm = $('#textinput6').val();
                    var weeks = $('#textinput7').val();
                    var days = $('#textinput15').val();
                    var edd = $('#textinput8').val();
                    var pastdate = $('#textinput9').val();
                    var pastweeks = $('#textinput11').val();
                    var pastdays = $('#textinput12').val();
                    var result = ""
                    var now = new Date()

                    if(lnm != ""){
                        
                        var lnmDate = checkMonthDate(lnm);                       
                        var eddDate = new Date(lnmDate.getTime()+(86400000 * 280));
                        var timeDiff = Math.abs(now.getTime() - lnmDate.getTime());
                        var diffDays = Math.floor(timeDiff / (1000 * 3600 * 24));
                        var myweeks = Math.floor(diffDays / 7);
                        var mydays = diffDays % 7;
                        result = resultOutput(lnmDate, eddDate, myweeks, mydays);

                    }  else if (edd != ""){

                        var eddDate = checkMonthDate(edd);
                        var lnmDate = new Date(eddDate.getTime()-(86400000 * 280));
                        var timeDiff = Math.abs(now.getTime() - lnmDate.getTime());
                        var diffDays = Math.floor(timeDiff / (1000 * 3600 * 24));
                        var myweeks = Math.floor(diffDays / 7);
                        var mydays = diffDays % 7;
                        result = resultOutput(lnmDate, eddDate, myweeks, mydays);

                    } else if (pastdate != ""){
                        if (pastweeks == "0" && pastdays == "0"){
                            result += "Weeks and days can not be 0. Please enter new values."
                        } else if (pastweeks != "0" || pastdays != "0"){
                            var pastDate = checkMonthDate(pastdate);
                            var totalDays = (7 * parseInt(pastweeks, 10)) + parseInt(pastdays, 10);
                            var lnmDate = new Date(pastDate.getTime()-(1000 * 3600 * 24 * totalDays));
                            var eddDate = new Date(lnmDate.getTime()+(86400000 * 280));
                            result = resultOutput(lnmDate, eddDate, pastweeks, pastdays);
                        }
                      
                        
                    } else if (weeks != "0" || days != "0"){
                        var totalDays = (7 * parseInt(weeks, 10)) + parseInt(days, 10);
                        var futureDays = 180 - totalDays;
                        var lnmtoday = new Date();
                        lnmtoday.setDate(lnmtoday.getDate()-totalDays)
                        var lnmDate = new Date(lnmtoday);
                        var eddtoday = new Date();
                        eddtoday.setDate(eddtoday.getDate()+futureDays);
                        var eddDate = new Date(eddtoday);
                        result = resultOutput(lnmDate, eddDate, weeks, days);
                    }  else {
                        result += "You did not enter the values correctly. Please enter new values.";
                    }                      
                    $('#result').html(result);
                    // clearValues();
                    
                }
                </script>
            </div>
        </div>
        <script>
              //App custom javascript
              function clearValues(){
                $('#textinput6').val("");
                $('#textinput7').val(0);
                $('#textinput15').val(0);
                $('#textinput8').val("");
                $('#textinput9').val("");
                $('#textinput11').val(0);
                $('#textinput12').val(0); 
                $('#result').html("");
              }
              function resultOutput(templnm, tempedd, tempweeks, tempdays){
                    var result = "";

                    result += "Last Normal Mentruation:</br></br><b>" + templnm.toDateString() + "</b></br></br>";
                    result += "Expected Date of Delivery:</br></br><b>" + tempedd.toDateString() + "</b></br></br>";
                    result += "Currently <b>" + tempweeks + " weeks</b> and <b>" + tempdays + " days</b> pregnant.</br></br>";

                    

                    return result;
              }
              // Check if calendar month date is 1 or 2 digits
                function checkMonthDate(checkDate){
                    if (checkDate.length == 9){
                        var year = parseInt(checkDate.substring(5,9));
                        var month = parseInt(checkDate.substring(0,1));
                        var day = parseInt(checkDate.substring(2,4));
                    } else{
                        var year = parseInt(checkDate.substring(6,10));
                        var month = parseInt(checkDate.substring(0,2));
                        var day = parseInt(checkDate.substring(3,5));
                    }
                    month -= 1;
                    var multiDate = new Date(year, month, day, 0, 0, 0, 0);
                    return multiDate;
                }
        </script>
    </body>

</html>